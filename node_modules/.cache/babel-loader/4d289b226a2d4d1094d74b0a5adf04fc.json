{"ast":null,"code":"import _slicedToArray from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/** @jsxImportSource theme-ui */import{Storage}from\"@capacitor/storage\";import{IonAlert,IonButtons,IonCol,IonContent,IonDatetime,IonGrid,IonHeader,IonItem,IonLabel,IonLoading,IonMenuButton,IonPage,IonRow,IonTitle,IonToolbar,useIonViewWillEnter}from\"@ionic/react\";import React,{useState}from\"react\";import{useHistory}from\"react-router\";import CalCard from\"../../components/Card/CalCard\";import Connection from\"../../mixins/Connection\";import{jsx as _jsx}from\"theme-ui/jsx-runtime\";import{jsxs as _jsxs}from\"theme-ui/jsx-runtime\";var Calendar=function Calendar(){useIonViewWillEnter(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return isSignedIn();case 2:getBookings(time);case 3:case\"end\":return _context.stop();}}},_callee);})));var history=useHistory();var isSignedIn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var id,adminId;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Storage.get({key:\"adminId\"});case 2:id=_context2.sent;adminId=id.value;if(adminId===null){setShowLoader(false);setShowLeave(true);}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function isSignedIn(){return _ref2.apply(this,arguments);};}();var getBookings=function getBookings(time){setShowLoader(true);var url='booking/get/'.concat(time);Connection.processGetRequest({},url,function(response){return mapResponse(response);});};var mapResponse=function mapResponse(response){if(response.type==='error'){setShowLoader(false);setMessage(response.data);setShowError(true);}else{setBookings(response.data.data);setShowLoader(false);}};var _useState=useState(true),_useState2=_slicedToArray(_useState,2),showLoader=_useState2[0],setShowLoader=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showError=_useState4[0],setShowError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showLeave=_useState6[0],setShowLeave=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];var _useState9=useState(new Date().toISOString()),_useState10=_slicedToArray(_useState9,2),time=_useState10[0],setTime=_useState10[1];var _useState11=useState([{bookingId:\"\",clientName:\"Test\",clientSurname:\"Test\",complexName:\"Test\",packageName:\"Test\",price:\"57\",startTime:new Date().toDateString(),endTime:new Date().toDateString()}]),_useState12=_slicedToArray(_useState11,2),bookings=_useState12[0],setBookings=_useState12[1];var updateTime=function updateTime(currentTime){setTime(currentTime);getBookings(currentTime);};return _jsxs(IonPage,{children:[_jsx(IonLoading,{cssClass:\"my-custom-class\",showBackdrop:true,isOpen:showLoader,message:'Please wait...'}),_jsx(IonAlert,{isOpen:showError,onDidDismiss:function onDidDismiss(){return setShowError(false);},header:'Error',subHeader:'Something went wrong.',message:message,buttons:['OK']}),_jsx(IonAlert,{isOpen:showLeave,onDidDismiss:function onDidDismiss(){return history.replace(\"/signIn\");},header:\"Error\",subHeader:\"You aren't signed in. Please sign in before continuing.\",buttons:[\"OK\"]}),_jsx(IonHeader,{children:_jsxs(IonToolbar,{color:\"primary\",children:[_jsx(IonButtons,{slot:\"start\",children:_jsx(IonMenuButton,{})}),_jsx(IonTitle,{children:\"Calendar\"})]})}),_jsx(IonContent,{fullscreen:true,children:_jsxs(IonGrid,{children:[_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(IonItem,{children:[_jsx(IonLabel,{children:\"Select a date\"}),_jsx(IonDatetime,{min:\"2021\",value:time,onIonChange:function onIonChange(e){return updateTime(e.detail.value);}})]})})}),bookings.length!==0&&bookings.map(function(booking){return _jsx(CalCard,{name:booking.clientName,surname:booking.clientSurname,complexName:booking.complexName,packageName:booking.packageName,price:booking.price,startTime:booking.startTime,endTime:booking.endTime},booking.bookingId);}),bookings.length===0&&_jsx(IonRow,{sx:styles.row,children:_jsx(IonCol,{children:_jsx(\"h1\",{sx:styles.heading,children:\"No Bookings \"})})})]})})]});};export default Calendar;var styles={heading:{display:\"flex\",justifyContent:\"center\",color:\"grey\"},row:{mt:'30vh',borderRadius:'8px',opacity:'0.5'}};","map":{"version":3,"sources":["/Users/onceknownriley/Documents/GreenWashProject/Admin/src/pages/Calendar/Calendar.tsx"],"names":["Storage","IonAlert","IonButtons","IonCol","IonContent","IonDatetime","IonGrid","IonHeader","IonItem","IonLabel","IonLoading","IonMenuButton","IonPage","IonRow","IonTitle","IonToolbar","useIonViewWillEnter","React","useState","useHistory","CalCard","Connection","Calendar","isSignedIn","getBookings","time","history","get","key","id","adminId","value","setShowLoader","setShowLeave","url","concat","processGetRequest","response","mapResponse","type","setMessage","data","setShowError","setBookings","showLoader","showError","showLeave","message","Date","toISOString","setTime","bookingId","clientName","clientSurname","complexName","packageName","price","startTime","toDateString","endTime","bookings","updateTime","currentTime","replace","e","detail","length","map","booking","styles","row","heading","display","justifyContent","color","mt","borderRadius","opacity"],"mappings":"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","sourcesContent":["/** @jsxImportSource theme-ui */\nimport { Storage } from \"@capacitor/storage\";\nimport {\n  IonAlert,\n  IonButtons,\n  IonCol,\n  IonContent,\n  IonDatetime,\n  IonGrid,\n  IonHeader,\n  IonItem,\n  IonLabel,\n  IonLoading,\n  IonMenuButton,\n  IonPage,\n  IonRow,\n  IonTitle,\n  IonToolbar,\n  useIonViewWillEnter,\n} from \"@ionic/react\";\nimport React, { useState } from \"react\";\nimport { useHistory } from \"react-router\";\nimport CalCard from \"../../components/Card/CalCard\";\nimport Connection from \"../../mixins/Connection\";\n\nconst Calendar: React.FC = () => {\n  useIonViewWillEnter(async() =>{\n    await isSignedIn();\n    getBookings(time);\n  })\n  const history = useHistory();\n\n  const isSignedIn = async() => {\n    const id = await Storage.get({key: \"adminId\"});\n    const adminId = id.value;\n\n    if(adminId === null){\n      setShowLoader(false);\n      setShowLeave(true);\n    }\n  }\n\n  const getBookings = (time: any) => {\n    setShowLoader(true);\n    let url = 'booking/get/'.concat(time);\n    Connection.processGetRequest({}, url, (response: any) => mapResponse(response))\n  };\n\n const mapResponse = (response: any) => {\n   if(response.type === 'error'){\n     setShowLoader(false);\n     setMessage(response.data);\n     setShowError(true);\n   }else{\n     setBookings(response.data.data);\n     setShowLoader(false)\n   }\n }\n\n  const [showLoader, setShowLoader] = useState(true);\n  const [showError, setShowError] = useState(false);\n  const [showLeave, setShowLeave] = useState(false);\n  const [message, setMessage] = useState(\"\");\n\n  const [time, setTime] = useState(new Date().toISOString());\n  const [bookings, setBookings] = useState([\n    {\n      bookingId: \"\",\n      clientName: \"Test\",\n      clientSurname: \"Test\",\n      complexName: \"Test\",\n      packageName: \"Test\",\n      price: \"57\",\n      startTime: new Date().toDateString(),\n      endTime: new Date().toDateString(),\n    },\n  ]);\n  const updateTime = (currentTime: any) => {\n    setTime(currentTime);\n    getBookings(currentTime);\n  };\n  return (\n    <IonPage>\n      <IonLoading\n            cssClass='my-custom-class'\n            showBackdrop\n            isOpen={showLoader}\n            message={'Please wait...'}\n          />\n          <IonAlert\n          isOpen={showError}\n          onDidDismiss={() => setShowError(false)}\n          header={'Error'}\n          subHeader={'Something went wrong.'}\n          message={message}\n          buttons={['OK']}\n        />\n        <IonAlert\n        isOpen={showLeave}\n        onDidDismiss={() => history.replace(\"/signIn\")}\n        header={\"Error\"}\n        subHeader={\"You aren't signed in. Please sign in before continuing.\"}\n        buttons={[\"OK\"]}\n      />\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonButtons slot=\"start\">\n            <IonMenuButton />\n          </IonButtons>\n          <IonTitle>Calendar</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent fullscreen>\n        <IonGrid>\n          <IonRow>\n            <IonCol>\n              <IonItem>\n                <IonLabel>Select a date</IonLabel>\n                <IonDatetime\n                  min=\"2021\"\n                  value={time}\n                  onIonChange={(e) => updateTime(e.detail.value)}\n                />\n              </IonItem>\n            </IonCol>\n          </IonRow>\n          {bookings.length !== 0 &&\n            bookings.map((booking) => (\n              <CalCard\n                key={booking.bookingId}\n                name={booking.clientName}\n                surname={booking.clientSurname}\n                complexName={booking.complexName}\n                packageName={booking.packageName}\n                price={booking.price}\n                startTime={booking.startTime}\n                endTime={booking.endTime}\n              />\n            ))}\n\n          {bookings.length === 0 && (\n            <IonRow sx={styles.row}>\n              <IonCol>\n                <h1 sx={styles.heading}>No Bookings </h1>\n              </IonCol>\n            </IonRow>\n          )}\n        </IonGrid>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Calendar;\n\nconst styles = {\n  heading: {\n    display: \"flex\",\n    justifyContent: \"center\",\n    color: \"grey\",\n  },\n  row: {\n    mt:'30vh',\n    borderRadius: '8px',\n    opacity: '0.5'\n  },\n};\n"]},"metadata":{},"sourceType":"module"}