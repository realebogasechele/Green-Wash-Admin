{"ast":null,"code":"import _slicedToArray from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/** @jsxImportSource theme-ui */import{Storage}from\"@capacitor/storage\";import{IonAlert,IonButtons,IonCard,IonCardContent,IonCardHeader,IonCardTitle,IonCol,IonContent,IonGrid,IonHeader,IonLoading,IonMenuButton,IonPage,IonRow,IonTitle,IonToolbar,useIonViewWillEnter}from\"@ionic/react\";import React,{useState}from\"react\";import{Bar,Doughnut,Pie}from\"react-chartjs-2\";import{useHistory}from\"react-router\";import Connection from\"../../mixins/Connection\";import{jsx as _jsx}from\"theme-ui/jsx-runtime\";import{jsxs as _jsxs}from\"theme-ui/jsx-runtime\";var Dashboard=function Dashboard(){var history=useHistory();useIonViewWillEnter(function(){setShowLoader(true);getAdminId();getPast7Days();getPopularity();getPopulation();getMostBookings();getTotalEarnings();getTypeOBookings();setShowLoader(false);});var getMostBookings=function getMostBookings(){var url=\"query/complexMostBookings\";Connection.processGetRequest({},url,function(response){mapMostBookings(response);});};var past7Days;var packPopularity;var clientPopulation;var getAdminId=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var id,adminId;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Storage.get({key:\"adminId\"});case 2:id=_context.sent;adminId=id.value;if(adminId!==null){getAdminDetails(adminId);}else{setShowLeave(true);}case 5:case\"end\":return _context.stop();}}},_callee);}));return function getAdminId(){return _ref.apply(this,arguments);};}();var _useState=useState({adminId:\"\",name:\"\",surname:\"\",cellNum:\"\",email:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),admin=_useState2[0],setAdmin=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),past7DaysValues=_useState4[0],setPast7DaysValues=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),packPopularityNames=_useState6[0],setPackPopularityNames=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),packPopularityValues=_useState8[0],setPackPopularityValues=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),complexNames=_useState10[0],setComplexNames=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),clients=_useState12[0],setClients=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),mostBookings=_useState14[0],setMostBookings=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),totalEarnings=_useState16[0],setTotalEarnings=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),typeOfBookings=_useState18[0],setTypeOfBookings=_useState18[1];var _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),showLoader=_useState20[0],setShowLoader=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),showLeave=_useState22[0],setShowLeave=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),showError=_useState24[0],setShowError=_useState24[1];var _useState25=useState(\"\"),_useState26=_slicedToArray(_useState25,2),errorMessage=_useState26[0],setErrorMessage=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),callDone=_useState28[0],setCallDone=_useState28[1];var getAdminDetails=function getAdminDetails(adminId){var url=\"get/\".concat(adminId);Connection.processGetRequest({},url,function(response){return mapAdminDetails(response);});};var getPast7Days=function getPast7Days(){var url=\"query/past7Days\";Connection.processGetRequest({},url,function(response){return mapPast7Days(response);});};var getPopularity=function getPopularity(){var url=\"query/packagePopularity\";Connection.processGetRequest({},url,function(response){return mapPopularity(response);});};var getPopulation=function getPopulation(){var url=\"query/clientPopulation\";Connection.processGetRequest({},url,function(response){return mapPopulation(response);});};var getTypeOBookings=function getTypeOBookings(){var url='query/typeOfBookingsToday';Connection.processGetRequest({},url,function(response){return mapBookingResponse(response);});};var getTotalEarnings=function getTotalEarnings(){var url='query/totalEarningsToday';Connection.processGetRequest({},url,function(response){return mapEarningResponse(response);});};var mapEarningResponse=function mapEarningResponse(response){if(response.type==='error'){setShowLoader(false);setErrorMessage(response.data);setShowError(true);}else{setTotalEarnings(response.data.data);}};var mapBookingResponse=function mapBookingResponse(response){if(response.type==='error'){setShowLoader(false);setErrorMessage(response.data);setShowError(true);}else{setTypeOfBookings(response.data.data);}};var mapPopulation=function mapPopulation(response){if(response.type===\"error\"){setShowLoader(false);setErrorMessage(response.data);setShowError(true);}else{clientPopulation=response.data.data;for(var i=0;i<clientPopulation.length;i++){complexNames.push(clientPopulation[i].name);clients.push(clientPopulation[i].value);}}};var mapPopularity=function mapPopularity(response){if(response.type===\"error\"){setShowLoader(false);setErrorMessage(response.data);setShowError(true);}else{packPopularity=response.data.data;for(var i=0;i<packPopularity.length;i++){packPopularityNames.push(packPopularity[i].name);packPopularityValues.push(packPopularity[i].value);}}};var mapAdminDetails=function mapAdminDetails(response){if(response.type===\"error\"){setShowLoader(false);setErrorMessage(response.data);setShowError(true);}else{setAdmin(response.data.data);setCallDone(true);}};var mapPast7Days=function mapPast7Days(response){if(response.type===\"error\"){setShowLoader(false);setErrorMessage(response.data);setShowError(true);}else{past7Days=response.data.data;for(var i=0;i<=past7Days.length-2;i++){past7DaysValues.push(past7Days[i].value);}setPast7DaysValues(past7DaysValues);}};var mapMostBookings=function mapMostBookings(response){if(response.type===\"error\"){setShowLoader(true);setErrorMessage(response.data);setShowError(true);}else{setMostBookings(response.data.data);}};var state={labels:[\"Today\",\"Yesterday\",\"2 Days Ago\",\"3 Days Ago\",\"4 Days Ago\",\"5 Days Ago\",\"6 Days Ago\",\"7 Days Ago\"],datasets:[{label:\"Bookings\",backgroundColor:\"rgba(91, 159, 78)\",borderColor:\"rgba(0,0,0,1)\",borderWidth:2,data:past7DaysValues}]};var state2={labels:packPopularityNames,datasets:[{label:\"Packages\",data:packPopularityValues,backgroundColor:[\"rgb(255, 99, 132)\",\"rgb(54, 162, 235)\",\"rgb(255, 205, 86)\"],hoverOffset:4}]};var state3={labels:complexNames,datasets:[{label:\"Clients\",data:clients,backgroundColor:[\"rgb(255, 99, 132)\",\"rgb(54, 162, 235)\",\"rgb(255, 205, 86)\"],hoverOffset:4}]};var state4={labels:[\"Cash\",\"Card\"],datasets:[{data:typeOfBookings,backgroundColor:[\"rgb(255, 99, 132)\",\"rgb(54, 162, 235)\",\"rgb(255, 205, 86)\"],hoverOffset:4}]};var state5={labels:[\"Cash\",\"Card\"],datasets:[{data:totalEarnings,backgroundColor:[\"rgb(255, 99, 132)\",\"rgb(54, 162, 235)\"],hoverOffset:4}]};var removeUnit=function removeUnit(){var temp=[];for(var i=0;i<packPopularityNames.length;i++){if(packPopularityNames[i]!==\"Default\"){temp.push(packPopularityNames[i]);}setPackPopularityNames(temp);}};return _jsxs(IonPage,{children:[_jsx(IonLoading,{cssClass:\"my-custom-class\",showBackdrop:true,isOpen:showLoader,message:\"Please wait...\"}),_jsx(IonAlert,{isOpen:showError,onDidDismiss:function onDidDismiss(){return setShowError(false);},header:\"Error\",subHeader:\"Something went wrong.\",message:errorMessage,buttons:[\"OK\"]}),_jsx(IonHeader,{children:_jsxs(IonToolbar,{color:\"primary\",children:[_jsx(IonButtons,{slot:\"start\",children:_jsx(IonMenuButton,{})}),_jsx(IonTitle,{children:\"Dashboard\"})]})}),_jsx(IonContent,{fullscreen:true,children:_jsxs(IonGrid,{children:[_jsx(IonRow,{children:_jsx(IonCol,{children:_jsx(IonTitle,{color:\"medium\",children:callDone===true?\"Welcome \"+admin.name+\" \"+admin.surname+\" !\":\"\"})})}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsx(IonCard,{children:_jsxs(IonCardHeader,{children:[_jsx(IonCardTitle,{color:\"medium\",children:\"Bookings for the past 7 days\"}),_jsx(IonCardContent,{children:packPopularityNames.length!==0&&packPopularityValues.length!==0&&_jsx(Bar,{data:state})})]})})})}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(IonCard,{children:[_jsx(IonCardHeader,{children:_jsx(IonRow,{children:_jsx(IonCol,{size:\"8\",children:_jsx(IonCardTitle,{color:\"medium\",children:\"Package Popularity\"})})})}),_jsx(IonCardContent,{children:packPopularityNames.length!==0&&packPopularityValues.length!==0&&_jsx(Pie,{data:state2})})]})})}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(IonCard,{children:[_jsx(IonCardHeader,{children:_jsx(IonRow,{children:_jsx(IonCol,{size:\"8\",children:_jsx(IonCardTitle,{color:\"medium\",children:\"Client Population\"})})})}),_jsx(IonCardContent,{children:packPopularityNames.length!==0&&packPopularityValues.length!==0&&_jsx(Doughnut,{data:state3})})]})})}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(IonCard,{children:[_jsx(IonCardHeader,{children:_jsx(IonCardTitle,{color:\"medium\",children:\"Type of Bookings Today\"})}),_jsx(IonCardContent,{children:packPopularityNames.length!==0&&packPopularityValues.length!==0&&_jsx(Doughnut,{data:state4})})]})})}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(IonCard,{children:[_jsx(IonCardHeader,{children:_jsx(IonCardTitle,{color:\"medium\",children:\"Total Earnings For Today\"})}),_jsx(IonCardContent,{children:packPopularityNames.length!==0&&packPopularityValues.length!==0&&_jsx(Doughnut,{data:state4})})]})})})]})})]});};export default Dashboard;","map":{"version":3,"sources":["/Users/onceknownriley/Documents/GreenWashProject/Admin/src/pages/Dashboard/Dashboard.tsx"],"names":["Storage","IonAlert","IonButtons","IonCard","IonCardContent","IonCardHeader","IonCardTitle","IonCol","IonContent","IonGrid","IonHeader","IonLoading","IonMenuButton","IonPage","IonRow","IonTitle","IonToolbar","useIonViewWillEnter","React","useState","Bar","Doughnut","Pie","useHistory","Connection","Dashboard","history","setShowLoader","getAdminId","getPast7Days","getPopularity","getPopulation","getMostBookings","getTotalEarnings","getTypeOBookings","url","processGetRequest","response","mapMostBookings","past7Days","packPopularity","clientPopulation","get","key","id","adminId","value","getAdminDetails","setShowLeave","name","surname","cellNum","email","password","admin","setAdmin","past7DaysValues","setPast7DaysValues","packPopularityNames","setPackPopularityNames","packPopularityValues","setPackPopularityValues","complexNames","setComplexNames","clients","setClients","mostBookings","setMostBookings","totalEarnings","setTotalEarnings","typeOfBookings","setTypeOfBookings","showLoader","showLeave","showError","setShowError","errorMessage","setErrorMessage","callDone","setCallDone","concat","mapAdminDetails","mapPast7Days","mapPopularity","mapPopulation","mapBookingResponse","mapEarningResponse","type","data","i","length","push","state","labels","datasets","label","backgroundColor","borderColor","borderWidth","state2","hoverOffset","state3","state4","state5","removeUnit","temp"],"mappings":"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","sourcesContent":["/** @jsxImportSource theme-ui */\nimport { Storage } from \"@capacitor/storage\";\nimport {\n  IonAlert,\n  IonButton,\n  IonButtons,\n  IonCard,\n  IonCardContent,\n  IonCardHeader,\n  IonCardTitle,\n  IonCol,\n  IonContent,\n  IonGrid,\n  IonHeader,\n  IonLoading,\n  IonMenuButton,\n  IonPage,\n  IonRow,\n  IonTitle,\n  IonToolbar,\n  useIonViewWillEnter,\n} from \"@ionic/react\";\nimport React, { useState } from \"react\";\nimport { Bar, Doughnut, Pie } from \"react-chartjs-2\";\nimport { useHistory } from \"react-router\";\nimport { App } from '@capacitor/app';\nimport Connection from \"../../mixins/Connection\";\n\ninterface ResponseObject {\n  name: string;\n  value: number;\n}\n\ninterface Admin {\n  adminId: string;\n  name: string;\n  surname: string;\n  cellNum: string;\n  email: string;\n  password: string;\n}\n\nconst Dashboard: React.FC = () => {\n  const history = useHistory();\n  useIonViewWillEnter(() => {\n    setShowLoader(true);\n    getAdminId();\n    getPast7Days();\n    getPopularity();\n    getPopulation();\n    getMostBookings();\n    getTotalEarnings();\n    getTypeOBookings();\n    setShowLoader(false);\n  });\n  const getMostBookings = () => {\n    let url = \"query/complexMostBookings\";\n    Connection.processGetRequest({}, url, (response: any) => {\n      mapMostBookings(response);\n    });\n  };\n  let past7Days: ResponseObject[];\n  let packPopularity: ResponseObject[];\n  let clientPopulation: ResponseObject[];\n\n  const getAdminId = async () => {\n    const id: any = await Storage.get({ key: \"adminId\" });\n    const adminId = id.value;\n    if(adminId !== null){\n      getAdminDetails(adminId);\n    }else{\n      setShowLeave(true);\n    }\n  };\n\n  const [admin, setAdmin] = useState({\n    adminId: \"\",\n    name: \"\",\n    surname: \"\",\n    cellNum: \"\",\n    email: \"\",\n    password: \"\",\n  });\n\n  const [past7DaysValues, setPast7DaysValues] = useState<number[]>([]);\n  const [packPopularityNames, setPackPopularityNames] = useState<string[]>([]);\n  const [packPopularityValues, setPackPopularityValues] = useState<number[]>(\n    []\n  );\n  const [complexNames, setComplexNames] = useState<string[]>([]);\n  const [clients, setClients] = useState<number[]>([]);\n  const [mostBookings, setMostBookings] = useState(\"\");\n  const [totalEarnings, setTotalEarnings] = useState([]);\n  const [typeOfBookings, setTypeOfBookings] = useState([]);\n\n  const [showLoader, setShowLoader] = useState(true);\n  const [showLeave, setShowLeave] = useState(false);\n  const [showError, setShowError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [callDone, setCallDone] = useState(false);\n\n  const getAdminDetails = (adminId: string) => {\n    let url = \"get/\".concat(adminId);\n    Connection.processGetRequest({}, url, (response: any) =>\n      mapAdminDetails(response)\n    );\n  };\n\n  const getPast7Days = () => {\n    let url = \"query/past7Days\";\n    Connection.processGetRequest({}, url, (response: any) => \n      mapPast7Days(response)\n    );\n  };\n\n  const getPopularity = () => {\n    let url = \"query/packagePopularity\";\n    Connection.processGetRequest({}, url, (response: any) =>\n      mapPopularity(response)\n    );\n  };\n\n  const getPopulation = () => {\n    let url = \"query/clientPopulation\";\n    Connection.processGetRequest({}, url, (response: any) => \n      mapPopulation(response)\n    );\n  };\n  const getTypeOBookings = () => {\n    let url = 'query/typeOfBookingsToday';\n    Connection.processGetRequest({}, url, (response: any) => mapBookingResponse(response))\n  };\n  const getTotalEarnings = () => {\n    let url = 'query/totalEarningsToday';\n    Connection.processGetRequest({}, url, (response: any) => mapEarningResponse(response))\n  };\n  const mapEarningResponse = (response: any) => {\n    if(response.type === 'error'){\n      setShowLoader(false);\n      setErrorMessage(response.data);\n      setShowError(true);\n    }else{\n      setTotalEarnings(response.data.data);\n\n    }\n  };\n  const mapBookingResponse = (response: any) => {\n    if(response.type === 'error'){\n      setShowLoader(false);\n      setErrorMessage(response.data);\n      setShowError(true);\n    }else{\n      setTypeOfBookings(response.data.data);\n    }\n  };\n\n  const mapPopulation = (response: any) => {\n    if (response.type === \"error\") {\n      setShowLoader(false);\n      setErrorMessage(response.data);\n      setShowError(true);\n    } else {\n      clientPopulation = response.data.data;\n      for (let i = 0; i < clientPopulation.length; i++) {\n        complexNames.push(clientPopulation[i].name);\n        clients.push(clientPopulation[i].value);\n      }\n    }\n  };\n\n  const mapPopularity = (response: any) => {\n    if (response.type === \"error\") {\n      setShowLoader(false);\n      setErrorMessage(response.data);\n      setShowError(true);\n    } else {\n      packPopularity = response.data.data;\n      for (let i = 0; i < packPopularity.length; i++) {\n        packPopularityNames.push(packPopularity[i].name);\n        packPopularityValues.push(packPopularity[i].value);\n      }\n    }\n  };\n\n  const mapAdminDetails = (response: any) => {\n    if (response.type === \"error\") {\n      setShowLoader(false);\n      setErrorMessage(response.data);\n      setShowError(true);\n    } else {\n      setAdmin(response.data.data);\n      setCallDone(true);\n    }\n  };\n\n  const mapPast7Days = (response: any) => {\n    if (response.type === \"error\") {\n      setShowLoader(false);\n      setErrorMessage(response.data);\n      setShowError(true);\n    } else {\n      past7Days = response.data.data;\n      for (let i = 0; i <= past7Days.length - 2; i++) {\n        past7DaysValues.push(past7Days[i].value);\n      }\n      setPast7DaysValues(past7DaysValues);\n    }\n  };\n\n  const mapMostBookings = (response: any) => {\n    if (response.type === \"error\") {\n      setShowLoader(true);\n      setErrorMessage(response.data);\n      setShowError(true);\n    } else {\n      setMostBookings(response.data.data);\n    }\n  };\n\n  const state = {\n    labels: [\n      \"Today\",\n      \"Yesterday\",\n      \"2 Days Ago\",\n      \"3 Days Ago\",\n      \"4 Days Ago\",\n      \"5 Days Ago\",\n      \"6 Days Ago\",\n      \"7 Days Ago\",\n    ],\n    datasets: [\n      {\n        label: \"Bookings\",\n        backgroundColor: \"rgba(91, 159, 78)\",\n        borderColor: \"rgba(0,0,0,1)\",\n        borderWidth: 2,\n        data: past7DaysValues,\n      },\n    ],\n  };\n  const state2 = {\n    labels: packPopularityNames,\n    datasets: [\n      {\n        label: \"Packages\",\n        data: packPopularityValues,\n        backgroundColor: [\n          \"rgb(255, 99, 132)\",\n          \"rgb(54, 162, 235)\",\n          \"rgb(255, 205, 86)\",\n        ],\n        hoverOffset: 4,\n      },\n    ],\n  };\n\n  const state3 = {\n    labels: complexNames,\n    datasets: [\n      {\n        label: \"Clients\",\n        data: clients,\n        backgroundColor: [\n          \"rgb(255, 99, 132)\",\n          \"rgb(54, 162, 235)\",\n          \"rgb(255, 205, 86)\",\n        ],\n        hoverOffset: 4,\n      },\n    ],\n  };\n  const state4 = {\n    labels: [\"Cash\", \"Card\"],\n    datasets: [\n      {\n        data: typeOfBookings,\n        backgroundColor: [\n          \"rgb(255, 99, 132)\",\n          \"rgb(54, 162, 235)\",\n          \"rgb(255, 205, 86)\",\n        ],\n        hoverOffset: 4,\n      },\n    ],\n  };\n  const state5 = {\n    labels: [\"Cash\", \"Card\"],\n    datasets: [\n      {\n        data: totalEarnings,\n        backgroundColor: [\n          \"rgb(255, 99, 132)\",\n          \"rgb(54, 162, 235)\",\n        ],\n        hoverOffset: 4,\n      },\n    ],\n  };\n\n  const removeUnit = () => {\n    let temp: string[] = [];\n    for (let i = 0; i < packPopularityNames.length; i++) {\n      if (packPopularityNames[i] !== \"Default\") {\n        temp.push(packPopularityNames[i]);\n      }\n      setPackPopularityNames(temp);\n    }\n  };\n\n  return (\n    <IonPage>\n      <IonLoading\n        cssClass=\"my-custom-class\"\n        showBackdrop\n        isOpen={showLoader}\n        message={\"Please wait...\"}\n      />\n\n      <IonAlert\n        isOpen={showError}\n        onDidDismiss={() => setShowError(false)}\n        header={\"Error\"}\n        subHeader={\"Something went wrong.\"}\n        message={errorMessage}\n        buttons={[\"OK\"]}\n      />\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonButtons slot=\"start\">\n            <IonMenuButton />\n          </IonButtons>\n          <IonTitle>Dashboard</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n\n      <IonContent fullscreen>\n        <IonGrid>\n          <IonRow>\n            <IonCol>\n              <IonTitle color=\"medium\">\n                {callDone === true\n                  ? \"Welcome \" + admin.name + \" \" + admin.surname + \" !\"\n                  : \"\"}\n              </IonTitle>\n            </IonCol>\n          </IonRow>\n          <IonRow>\n            <IonCol>\n              <IonCard>\n                <IonCardHeader>\n                  <IonCardTitle color=\"medium\">\n                    Bookings for the past 7 days\n                  </IonCardTitle>\n                  <IonCardContent>\n                    {packPopularityNames.length !== 0 &&\n                      packPopularityValues.length !== 0 && <Bar data={state} />}\n                  </IonCardContent>\n                </IonCardHeader>\n              </IonCard>\n            </IonCol>\n          </IonRow>\n          <IonRow>\n            <IonCol>\n              <IonCard>\n                <IonCardHeader>\n                  <IonRow>\n                    <IonCol size=\"8\">\n                      <IonCardTitle color=\"medium\">\n                        Package Popularity\n                      </IonCardTitle>\n                    </IonCol>\n                  </IonRow>\n                </IonCardHeader>\n                <IonCardContent>\n                  {packPopularityNames.length !== 0 &&\n                    packPopularityValues.length !== 0 && <Pie data={state2} />}\n                </IonCardContent>\n              </IonCard>\n            </IonCol>\n          </IonRow>\n          <IonRow>\n            <IonCol>\n              <IonCard>\n                <IonCardHeader>\n                  <IonRow>\n                    <IonCol size=\"8\">\n                      <IonCardTitle color=\"medium\">\n                        Client Population\n                      </IonCardTitle>\n                    </IonCol>\n                  </IonRow>\n                </IonCardHeader>\n                <IonCardContent>\n                  {packPopularityNames.length !== 0 &&\n                    packPopularityValues.length !== 0 && (\n                      <Doughnut data={state3} />\n                    )}\n                </IonCardContent>\n              </IonCard>\n            </IonCol>\n          </IonRow>\n          <IonRow>\n            <IonCol>\n              <IonCard>\n                <IonCardHeader>\n                  <IonCardTitle color=\"medium\">\n                    Type of Bookings Today\n                  </IonCardTitle>\n                </IonCardHeader>\n                <IonCardContent>\n                  {packPopularityNames.length !== 0 &&\n                    packPopularityValues.length !== 0 && (\n                      <Doughnut data={state4} />\n                    )}\n                </IonCardContent>\n              </IonCard>\n            </IonCol>\n          </IonRow>\n          <IonRow>\n            <IonCol>\n              <IonCard>\n                <IonCardHeader>\n                  <IonCardTitle color=\"medium\">\n                    Total Earnings For Today\n                  </IonCardTitle>\n                </IonCardHeader>\n                <IonCardContent>\n                  {packPopularityNames.length !== 0 &&\n                    packPopularityValues.length !== 0 && (\n                      <Doughnut data={state4} />\n                    )}\n                </IonCardContent>\n              </IonCard>\n            </IonCol>\n          </IonRow>\n        </IonGrid>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default Dashboard;"]},"metadata":{},"sourceType":"module"}