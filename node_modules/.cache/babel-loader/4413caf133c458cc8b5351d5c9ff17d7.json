{"ast":null,"code":"import _regeneratorRuntime from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/** @jsxImportSource theme-ui */import{Storage}from\"@capacitor/storage\";import{IonAlert,IonBackButton,IonButton,IonButtons,IonCard,IonCardContent,IonCardHeader,IonCardSubtitle,IonCol,IonContent,IonGrid,IonHeader,IonInput,IonItem,IonLabel,IonLoading,IonPage,IonRow,IonTitle,IonToolbar}from\"@ionic/react\";import React,{useState}from\"react\";import{useHistory}from\"react-router\";import{validOtp}from\"../../components/Regex/Regex\";import Connection from\"../../mixins/Connection\";import{jsx as _jsx}from\"theme-ui/jsx-runtime\";import{jsxs as _jsxs}from\"theme-ui/jsx-runtime\";var RecoverOtp=function RecoverOtp(){var history=useHistory();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),otp=_useState2[0],setOtp=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showError=_useState6[0],setShowError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showLoader=_useState8[0],setShowLoader=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showSuccess=_useState10[0],setShowSuccess=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showSuccessResend=_useState12[0],setShowSuccessResend=_useState12[1];var updateOtp=function updateOtp(otp){return setOtp(otp);};var getId=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(username){var id,adminId,url;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Storage.get({key:\"adminId\"});case 2:id=_context.sent;adminId=id.value;url=\"resendOtp/\";case 5:case\"end\":return _context.stop();}}},_callee);}));return function getId(_x){return _ref.apply(this,arguments);};}();var getUsername=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var id,username;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Storage.get({key:\"username\"});case 2:id=_context2.sent;username=id.value;getId(username);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function getUsername(){return _ref2.apply(this,arguments);};}();var getAdminId=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var id,adminId,time,url;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return Storage.get({key:\"adminId\"});case 2:id=_context3.sent;adminId=id.value;time=new Date().toISOString();url=\"recovery/recover/\".concat(otp,\"/\",adminId,\"/\",time);Connection.processPostRequest({},url,function(response){return mapResponse(response);});case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function getAdminId(){return _ref3.apply(this,arguments);};}();var mapResponse=function mapResponse(response){if(response.type===\"error\"){setShowLoader(false);setMessage(\"Otp Error.\");setShowError(true);}else{setShowLoader(false);setMessage(\"Account Recovered.\");setShowSuccess(true);}};var resendOtp=function resendOtp(){getUsername();};var buttonHandler=function buttonHandler(){if(!validOtp.test(otp)){setShowLoader(false);setMessage(\"Invalid Otp\");setShowError(true);}else{getAdminId();}};return _jsxs(IonPage,{children:[_jsx(IonLoading,{cssClass:\"my-custom-class\",showBackdrop:true,isOpen:showLoader,message:\"Please wait...\"}),_jsx(IonAlert,{isOpen:showError,onDidDismiss:function onDidDismiss(){return setShowError(false);},header:\"Error\",message:message,buttons:[\"OK\"]}),_jsx(IonAlert,{isOpen:showSuccessResend,onDidDismiss:function onDidDismiss(){return history.replace(\"/signIn\");},header:\"Success\",message:message,buttons:[\"OK\"]}),_jsx(IonAlert,{isOpen:showSuccess,onDidDismiss:function onDidDismiss(){return setShowSuccess(false);},header:\"Success\",message:message,buttons:[\"OK\"]}),_jsx(IonHeader,{children:_jsxs(IonToolbar,{color:\"primary\",children:[_jsx(IonButtons,{children:_jsx(IonBackButton,{})}),_jsx(IonTitle,{children:\"Verify Otp\"})]})}),_jsx(IonContent,{children:_jsx(IonGrid,{children:_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(IonCard,{sx:styles.card,children:[_jsx(IonCardHeader,{children:_jsx(IonCardSubtitle,{style:{textAlign:\"center\"},children:\"Enter the otp that was sent to the respective choice of medium\"})}),_jsxs(IonCardContent,{children:[_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(IonItem,{children:[_jsx(IonLabel,{position:\"floating\",children:\"One-Time Pin\"}),_jsx(IonInput,{type:\"text\",value:otp,onIonChange:function onIonChange(e){return updateOtp(e.detail.value);}})]})})}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsx(IonButton,{type:\"submit\",expand:\"block\",shape:\"round\",sx:styles.button,onClick:function onClick(){return buttonHandler();},children:\"Verify\"})})}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(\"p\",{style:{textAlign:\"center\"},children:[\"Didn't recieve it ? \",_jsx(\"a\",{onClick:function onClick(){return resendOtp();},children:\"Resend One-Time Pin\"})]})})})]})]})})})})})]});};export default RecoverOtp;var styles={card:{mt:\"23vh\"},button:{mt:\"3\",mb:\"4\"}};","map":{"version":3,"sources":["/Users/onceknownriley/Documents/GreenWashProject/Admin/src/pages/Recover Account/RecoverOtp.tsx"],"names":["Storage","IonAlert","IonBackButton","IonButton","IonButtons","IonCard","IonCardContent","IonCardHeader","IonCardSubtitle","IonCol","IonContent","IonGrid","IonHeader","IonInput","IonItem","IonLabel","IonLoading","IonPage","IonRow","IonTitle","IonToolbar","React","useState","useHistory","validOtp","Connection","RecoverOtp","history","otp","setOtp","message","setMessage","showError","setShowError","showLoader","setShowLoader","showSuccess","setShowSuccess","showSuccessResend","setShowSuccessResend","updateOtp","getId","username","get","key","id","adminId","value","url","getUsername","getAdminId","time","Date","toISOString","concat","processPostRequest","response","mapResponse","type","resendOtp","buttonHandler","test","replace","styles","card","textAlign","e","detail","button","mt","mb"],"mappings":"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","sourcesContent":["/** @jsxImportSource theme-ui */\nimport { Storage } from \"@capacitor/storage\";\nimport {\n    IonAlert,\n  IonBackButton,\n  IonButton,\n  IonButtons,\n  IonCard,\n  IonCardContent,\n  IonCardHeader,\n  IonCardSubtitle,\n  IonCol,\n  IonContent,\n  IonGrid,\n  IonHeader,\n  IonInput,\n  IonItem,\n  IonLabel,\n  IonLoading,\n  IonPage,\n  IonRow,\n  IonTitle,\n  IonToolbar,\n} from \"@ionic/react\";\nimport React, { useState } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { validOtp } from \"../../components/Regex/Regex\";\nimport Connection from \"../../mixins/Connection\";\n\nconst RecoverOtp: React.FC = () => {\n  const history = useHistory();\n  const [otp, setOtp] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  const [showError, setShowError] = useState(false);\n  const [showLoader, setShowLoader] = useState(false);\n  const [showSuccess, setShowSuccess] = useState(false);\n  const [showSuccessResend, setShowSuccessResend] = useState(false);\n\n  const updateOtp = (otp: any) => setOtp(otp);\n  const getId = async(username: any) => {\n    const id: any = await Storage.get({key: \"adminId\"});\n    const adminId: any = id.value;\n\n    let url = \"resendOtp/\"\n  };\nconst getUsername = async() => {\n  const id: any = await Storage.get({key: \"username\"});\n  const username: any = id.value;\n\n  getId(username);\n};\n  const getAdminId = async() => {\n    const id: any = await Storage.get({key: \"adminId\"});\n    const adminId: any = id.value;\n\n    const time = new Date().toISOString();\n\n    let url = \"recovery/recover/\".concat(otp, \"/\", adminId, \"/\", time);\n    Connection.processPostRequest({}, url, (response: any) => mapResponse(response))\n};\n\nconst mapResponse = (response: any) => {\n  if(response.type === \"error\"){\n      setShowLoader(false);\n      setMessage(\"Otp Error.\");\n      setShowError(true);\n  }else{\n      setShowLoader(false);\n      setMessage(\"Account Recovered.\");\n      setShowSuccess(true);\n  }\n};\n\n  const resendOtp = () => {\n      getUsername();\n  };\n\n  const buttonHandler = () => {\n      if(!validOtp.test(otp)){\n          setShowLoader(false);\n          setMessage(\"Invalid Otp\");\n          setShowError(true);\n      }else{\n          getAdminId();\n      }\n  };\n  return (\n    <IonPage>\n        <IonLoading\n        cssClass=\"my-custom-class\"\n        showBackdrop\n        isOpen={showLoader}\n        message={\"Please wait...\"}\n      />\n\n      <IonAlert\n        isOpen={showError}\n        onDidDismiss={() => setShowError(false)}\n        header={\"Error\"}\n        message={message}\n        buttons={[\"OK\"]}\n      />\n      <IonAlert\n        isOpen={showSuccessResend}\n        onDidDismiss={() => history.replace(\"/signIn\")}\n        header={\"Success\"}\n        message={message}\n        buttons={[\"OK\"]}\n      />\n      <IonAlert\n        isOpen={showSuccess}\n        onDidDismiss={() => setShowSuccess(false)}\n        header={\"Success\"}\n        message={message}\n        buttons={[\"OK\"]}\n      />\n      <IonHeader>\n        <IonToolbar color=\"primary\">\n          <IonButtons>\n            <IonBackButton />\n          </IonButtons>\n          <IonTitle>Verify Otp</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n        <IonGrid>\n          <IonRow>\n            <IonCol>\n              <IonCard sx={styles.card}>\n                <IonCardHeader>\n                  <IonCardSubtitle style={{ textAlign: \"center\" }}>\n                    Enter the otp that was sent to the respective choice of\n                    medium\n                  </IonCardSubtitle>\n                </IonCardHeader>\n                <IonCardContent>\n                  <IonRow>\n                    <IonCol>\n                      <IonItem>\n                        <IonLabel position=\"floating\">One-Time Pin</IonLabel>\n                        <IonInput\n                          type=\"text\"\n                          value={otp}\n                          onIonChange={(e) => updateOtp(e.detail.value)}\n                        />\n                      </IonItem>\n                    </IonCol>\n                  </IonRow>\n                  <IonRow>\n                      <IonCol>\n                          <IonButton type=\"submit\" expand=\"block\" shape=\"round\" sx={styles.button} onClick={()=>buttonHandler()}>Verify</IonButton>\n                      </IonCol>\n                  </IonRow>\n                  <IonRow>\n                      <IonCol>\n                          <p style={{textAlign: \"center\"}}>Didn't recieve it ? <a onClick={()=>resendOtp()}>Resend One-Time Pin</a></p>\n                      </IonCol>\n                  </IonRow>\n                </IonCardContent>\n              </IonCard>\n            </IonCol>\n          </IonRow>\n        </IonGrid>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default RecoverOtp;\n\nconst styles = {\n    card:{\n        mt: \"23vh\",\n    },\n    button: {\n        mt: \"3\",\n        mb: \"4\",\n    },\n};\n"]},"metadata":{},"sourceType":"module"}