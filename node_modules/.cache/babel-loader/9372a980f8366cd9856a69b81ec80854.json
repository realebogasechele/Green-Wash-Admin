{"ast":null,"code":"import _regeneratorRuntime from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/onceknownriley/Documents/GreenWashProject/Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/** @jsxImportSource theme-ui */import{IonAlert,IonButton,IonCard,IonCol,IonContent,IonGrid,IonImg,IonInput,IonItem,IonLabel,IonLoading,IonPage,IonRow,IonSelect,IonSelectOption,IonTitle,IonToolbar}from\"@ionic/react\";import React,{useState}from\"react\";import{useHistory}from\"react-router\";import TGWLogo from\"../../components/TGWLogo.png\";import Connection from\"../../mixins/Connection\";import{validCellNum,validEmail,validPassword}from\"../../components/Regex/Regex\";import{Storage}from\"@capacitor/storage\";import{jsx as _jsx}from\"theme-ui/jsx-runtime\";import{jsxs as _jsxs}from\"theme-ui/jsx-runtime\";var SignIn=function SignIn(){var path=useHistory();var valid=false;var load=false;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showLoader=_useState2[0],setShowLoader=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showError=_useState4[0],setShowError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showSuccess=_useState6[0],setShowSuccess=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),successMessage=_useState8[0],setSuccessMessage=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),errorMessage=_useState10[0],setErrorMessage=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),cellNum=_useState12[0],setCellNum=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),email=_useState14[0],setEmail=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),password=_useState16[0],setPassword=_useState16[1];var _useState17=useState(\"cell\"),_useState18=_slicedToArray(_useState17,2),selection=_useState18[0],setSelection=_useState18[1];var updateSelection=function updateSelection(selection){setSelection(selection);setEmail(\"\");setCellNum(\"\");setPassword(\"\");};var updateCellNum=function updateCellNum(cellNum){setCellNum(cellNum);};var updateEmail=function updateEmail(email){setEmail(email);};var updatePassword=function updatePassword(password){setPassword(password);};var setAdminId=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Storage.set({key:\"adminId\",value:data});case 2:case\"end\":return _context.stop();}}},_callee);}));return function setAdminId(_x){return _ref.apply(this,arguments);};}();var buttonHandler=function buttonHandler(){setShowLoader(true);if(selection===\"cell\"){if(cellNum===\"\"||password===\"\"){setShowLoader(false);valid=false;setErrorMessage(\"Fields cannot be empty.\");setShowError(true);}else if(!validCellNum.test(cellNum)){setShowLoader(false);valid=false;setErrorMessage(\"Invalid Cell Number.\");setShowError(true);}else if(!validPassword.test(password)){setShowLoader(false);valid=false;setErrorMessage(\"Password must be 8-16 characters long. Ensure it includes atleast 1 aphabet character and 1 digit.\");setShowError(true);}else{var url=\"login/cell/\".concat(cellNum,\"/\",password);Connection.processGetRequest({},url,function(response){return mapResponse(response);});}}else{if(email===\"\"||password===\"\"){setShowLoader(false);valid=false;setErrorMessage(\"Fields cannot be empty.\");setShowError(true);}else if(!validEmail.test(email)){setShowLoader(false);valid=false;setErrorMessage(\"Invalid Email.\");setShowError(true);}else if(!validPassword.test(password)){setShowLoader(false);valid=false;setErrorMessage(\"Password must be 8-16 characters long. Ensure it includes atleast 1 aphabet character and 1 digit.\");setShowError(true);}else{var _url=\"login/email/\".concat(email,\"/\",password);Connection.processGetRequest({},_url,function(response){return mapResponse(response);});}}};var mapResponse=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(response.type===\"error\")){_context2.next=9;break;}setShowLoader(false);setErrorMessage(response.data);setShowError(true);setCellNum(\"\");setEmail(\"\");setPassword(\"\");_context2.next=15;break;case 9:setShowLoader(false);_context2.next=12;return setAdminId(response.data.data);case 12:setSuccessMessage(\"Successfully Sign In!\");setShowSuccess(true);console.log(response.data.data);case 15:case\"end\":return _context2.stop();}}},_callee2);}));return function mapResponse(_x2){return _ref2.apply(this,arguments);};}();return _jsx(IonPage,{children:_jsxs(IonContent,{children:[_jsx(IonImg,{src:TGWLogo,alt:\"Logo.png\",sx:styles.img}),_jsxs(IonToolbar,{children:[_jsx(IonLoading,{cssClass:\"my-custom-class\",showBackdrop:true,isOpen:showLoader,message:\"Please wait...\"}),_jsx(IonAlert,{isOpen:showError,onDidDismiss:function onDidDismiss(){return setShowError(false);},header:\"Error\",subHeader:\"Something went wrong.\",message:errorMessage,buttons:[\"OK\"]}),_jsx(IonAlert,{isOpen:showSuccess,onDidDismiss:function onDidDismiss(){return path.push(\"/dashboard\");},header:\"Success\",subHeader:successMessage,buttons:[\"OK\"]}),_jsx(IonCard,{sx:{mt:\"8vh\"},children:_jsxs(IonGrid,{children:[_jsx(IonRow,{children:_jsx(IonCol,{offset:\"4\",children:_jsx(IonToolbar,{children:_jsx(IonTitle,{size:\"large\",children:\"Sign In\"})})})}),_jsxs(IonRow,{children:[_jsxs(IonCol,{size:\"8\",children:[selection===\"cell\"&&_jsxs(IonItem,{children:[_jsx(IonLabel,{position:\"floating\",children:\"Cell Number\"}),_jsx(IonInput,{value:cellNum,onIonChange:function onIonChange(e){return updateCellNum(e.detail.value);}})]}),selection===\"email\"&&_jsxs(IonItem,{children:[_jsx(IonLabel,{position:\"floating\",children:\"Email\"}),_jsx(IonInput,{value:email,onIonChange:function onIonChange(e){return updateEmail(e.detail.value);}})]})]}),_jsx(IonCol,{size:\"4\",children:_jsxs(IonSelect,{sx:styles.select,value:selection,onIonChange:function onIonChange(e){return updateSelection(e.detail.value);},children:[_jsx(IonSelectOption,{value:\"cell\",children:\"Cell Number\"}),_jsx(IonSelectOption,{value:\"email\",children:\"Email\"})]})})]}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsxs(IonItem,{children:[_jsx(IonLabel,{position:\"floating\",children:\"Password\"}),_jsx(IonInput,{type:\"password\",value:password,onIonChange:function onIonChange(e){return updatePassword(e.detail.value);}})]})})}),_jsx(IonRow,{children:_jsx(IonCol,{children:_jsx(IonButton,{shape:\"round\",type:\"submit\",expand:\"block\",onClick:function onClick(){return buttonHandler();},children:\"SignIn\"})})}),_jsx(IonRow,{children:_jsx(IonCol,{offset:\"4\",children:_jsx(\"p\",{children:_jsx(\"a\",{href:\"/forgot\",children:\"Forgot password ?\"})})})}),_jsx(IonRow,{children:_jsxs(IonCol,{offset:\"2.5\",children:[\"Don't have an account ? \",_jsx(\"a\",{href:\"/signUp\",children:\"Sign Up.\"})]})})]})})]})]})});};export default SignIn;var styles={img:{pt:\"6vh\",pl:\"4vh\",pr:\"4vh\"},select:{mt:\"15px\",border:\"1px solid grey\"}};","map":{"version":3,"sources":["/Users/onceknownriley/Documents/GreenWashProject/Admin/src/pages/SignIn/SignIn.tsx"],"names":["IonAlert","IonButton","IonCard","IonCol","IonContent","IonGrid","IonImg","IonInput","IonItem","IonLabel","IonLoading","IonPage","IonRow","IonSelect","IonSelectOption","IonTitle","IonToolbar","React","useState","useHistory","TGWLogo","Connection","validCellNum","validEmail","validPassword","Storage","SignIn","path","valid","load","showLoader","setShowLoader","showError","setShowError","showSuccess","setShowSuccess","successMessage","setSuccessMessage","errorMessage","setErrorMessage","cellNum","setCellNum","email","setEmail","password","setPassword","selection","setSelection","updateSelection","updateCellNum","updateEmail","updatePassword","setAdminId","data","set","key","value","buttonHandler","test","url","concat","processGetRequest","response","mapResponse","type","console","log","styles","img","push","mt","e","detail","select","pt","pl","pr","border"],"mappings":"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","sourcesContent":["/** @jsxImportSource theme-ui */\nimport {\n  IonAlert,\n  IonBackButton,\n  IonButton,\n  IonButtons,\n  IonCard,\n  IonCol,\n  IonContent,\n  IonFooter,\n  IonGrid,\n  IonHeader,\n  IonImg,\n  IonInput,\n  IonItem,\n  IonLabel,\n  IonLoading,\n  IonPage,\n  IonRow,\n  IonSelect,\n  IonSelectOption,\n  IonTitle,\n  IonToast,\n  IonToolbar,\n} from \"@ionic/react\";\nimport React, { useState } from \"react\";\nimport { useHistory } from \"react-router\";\nimport TGWLogo from \"../../components/TGWLogo.png\";\nimport Connection from \"../../mixins/Connection\";\nimport { validCellNum, validEmail, validPassword } from \"../../components/Regex/Regex\";\nimport { Storage } from \"@capacitor/storage\";\n\nconst SignIn: React.FC = () => {\n  const path = useHistory();\n\n  let valid: boolean = false;\n  let load: boolean = false;\n\n  const [showLoader, setShowLoader] = useState(false);\n  const [showError, setShowError] = useState(false);\n  const [showSuccess, setShowSuccess] = useState(false);\n  const [successMessage, setSuccessMessage] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  const [cellNum, setCellNum] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [selection, setSelection] = useState(\"cell\");\n\n  const updateSelection = (selection: any) => {\n    setSelection(selection);\n    setEmail(\"\");\n    setCellNum(\"\");\n    setPassword(\"\");\n  };\n\n  const updateCellNum = (cellNum: any) => {\n    setCellNum(cellNum);\n  };\n  const updateEmail = (email: any) => {\n    setEmail(email);\n  };\n  const updatePassword = (password: any) => {\n    setPassword(password);\n  };\n\n  const setAdminId = async (data: any) => {\n    await Storage.set({\n      key: \"adminId\",\n      value: data,\n    });\n  };\n\n  const buttonHandler = () => {\n    setShowLoader(true);\n    if (selection === \"cell\") {\n      if (cellNum === \"\" || password === \"\") {\n        setShowLoader(false);\n        valid = false;\n        setErrorMessage(\"Fields cannot be empty.\");\n        setShowError(true);\n      } else if (!validCellNum.test(cellNum)) {\n        setShowLoader(false);\n        valid = false;\n        setErrorMessage(\"Invalid Cell Number.\");\n        setShowError(true);\n      } else if (!validPassword.test(password)) {\n        setShowLoader(false);\n        valid = false;\n        setErrorMessage(\n          \"Password must be 8-16 characters long. Ensure it includes atleast 1 aphabet character and 1 digit.\"\n        );\n        setShowError(true);\n      } else {\n        let url = \"login/cell/\".concat(cellNum, \"/\", password);\n        Connection.processGetRequest({}, url, (response: any) =>\n          mapResponse(response)\n        );\n      }\n    } else {\n      if (email === \"\" || password === \"\") {\n        setShowLoader(false);\n        valid = false;\n        setErrorMessage(\"Fields cannot be empty.\");\n        setShowError(true);\n      } else if (!validEmail.test(email)) {\n        setShowLoader(false);\n        valid = false;\n        setErrorMessage(\"Invalid Email.\");\n        setShowError(true);\n      } else if (!validPassword.test(password)) {\n        setShowLoader(false);\n        valid = false;\n        setErrorMessage(\n          \"Password must be 8-16 characters long. Ensure it includes atleast 1 aphabet character and 1 digit.\"\n        );\n        setShowError(true);\n      } else {\n        let url = \"login/email/\".concat(email, \"/\", password);\n        Connection.processGetRequest({}, url, (response: any) =>\n          mapResponse(response)\n        );\n      }\n    }\n  };\n\n  const mapResponse = async(response: any) => {\n    if (response.type === \"error\") {\n      setShowLoader(false);\n      setErrorMessage(response.data);\n      setShowError(true);\n      setCellNum(\"\");\n      setEmail(\"\");\n      setPassword(\"\");\n    } else {\n      setShowLoader(false);\n      await setAdminId(response.data.data);\n      setSuccessMessage(\"Successfully Sign In!\");\n      setShowSuccess(true);\n      console.log(response.data.data)\n    }\n  };\n\n  return (\n    <IonPage>\n      <IonContent>\n        <IonImg src={TGWLogo} alt={\"Logo.png\"} sx={styles.img} />\n        <IonToolbar>\n          <IonLoading\n            cssClass=\"my-custom-class\"\n            showBackdrop\n            isOpen={showLoader}\n            message={\"Please wait...\"}\n          />\n\n          <IonAlert\n            isOpen={showError}\n            onDidDismiss={() => setShowError(false)}\n            header={\"Error\"}\n            subHeader={\"Something went wrong.\"}\n            message={errorMessage}\n            buttons={[\"OK\"]}\n          />\n\n          <IonAlert\n            isOpen={showSuccess}\n            onDidDismiss={() => path.push(\"/dashboard\")}\n            header={\"Success\"}\n            subHeader={successMessage}\n            buttons={[\"OK\"]}\n          />\n          <IonCard sx={{ mt: \"8vh\" }}>\n            <IonGrid>\n              <IonRow>\n                <IonCol offset=\"4\">\n                  <IonToolbar>\n                    <IonTitle size=\"large\">Sign In</IonTitle>\n                  </IonToolbar>\n                </IonCol>\n              </IonRow>\n              <IonRow>\n                <IonCol size=\"8\">\n                  {selection === \"cell\" && (\n                    <IonItem>\n                      <IonLabel position=\"floating\">Cell Number</IonLabel>\n                      <IonInput\n                        value={cellNum}\n                        onIonChange={(e) => updateCellNum(e.detail.value)}\n                      ></IonInput>\n                    </IonItem>\n                  )}\n                  {selection === \"email\" && (\n                    <IonItem>\n                      <IonLabel position=\"floating\">Email</IonLabel>\n                      <IonInput\n                        value={email}\n                        onIonChange={(e) => updateEmail(e.detail.value)}\n                      ></IonInput>\n                    </IonItem>\n                  )}\n                </IonCol>\n                <IonCol size=\"4\">\n                  <IonSelect\n                    sx={styles.select}\n                    value={selection}\n                    onIonChange={(e) => updateSelection(e.detail.value)}\n                  >\n                    <IonSelectOption value=\"cell\">Cell Number</IonSelectOption>\n                    <IonSelectOption value=\"email\">Email</IonSelectOption>\n                  </IonSelect>\n                </IonCol>\n              </IonRow>\n              <IonRow>\n                <IonCol>\n                  <IonItem>\n                    <IonLabel position=\"floating\">Password</IonLabel>\n                    <IonInput\n                      type=\"password\"\n                      value={password}\n                      onIonChange={(e) => updatePassword(e.detail.value)}\n                    ></IonInput>\n                  </IonItem>\n                </IonCol>\n              </IonRow>\n              <IonRow>\n                <IonCol>\n                  <IonButton\n                    shape=\"round\"\n                    type=\"submit\"\n                    expand=\"block\"\n                    onClick={() => buttonHandler()}\n                  >\n                    SignIn\n                  </IonButton>\n                </IonCol>\n              </IonRow>\n              <IonRow>\n                <IonCol offset=\"4\">\n                  <p>\n                    <a href=\"/forgot\">Forgot password ?</a>\n                  </p>\n                </IonCol>\n              </IonRow>\n              <IonRow>\n                <IonCol offset=\"2.5\">\n                  Don't have an account ? <a href=\"/signUp\">Sign Up.</a>\n                </IonCol>\n              </IonRow>\n            </IonGrid>\n          </IonCard>\n        </IonToolbar>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default SignIn;\n\nconst styles = {\n  img: {\n    pt: \"6vh\",\n    pl: \"4vh\",\n    pr: \"4vh\",\n  },\n  select: {\n    mt: \"15px\",\n    border: \"1px solid grey\",\n\n  },\n};\n"]},"metadata":{},"sourceType":"module"}